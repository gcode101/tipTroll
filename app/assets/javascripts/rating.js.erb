var ready = function() {
	var avgScore = $('.average_rating').data('score');
	averageRating(avgScore);

	var proAvgScore = $('.pro_average_rating').data('score');
	proAverageRating(proAvgScore);
};

$(document).ready(ready);
$(document).on('page:load', ready);

function averageRating(avgScore){
	$('.average_rating').raty({
		starOn: "<%= asset_path('img/star-on.png') %>",
		starOff: "<%= asset_path('img/star-off.png') %>",
		readOnly: true,
		score: avgScore
		});
	}

	function userRating(theScore, rating){
	$('.user_rating').raty({
		starOn: "<%= asset_path('img/star-on.png') %>",
        starOff: "<%= asset_path('img/star-off.png') %>",
		click: function(score, evt) {
      $.ajax({
        url: '/ratings/new',
        type: 'POST',
        data: {
        	score: score,
        	rating_type: ratingType,
        	rating_id: ratingId
        },
        success: function(data){
        	alert("Thanks for rating me!");
        	averageRating(data.average_rating);
        }
      });
		}
	});
}

function proAverageRating(proAvgScore){
	$('.pro_average_rating').raty({
		starOn: '<%= asset_path('star-on.png') %>',
		starOff: '<%= asset_path('star-off.png') %>',
		readOnly: true,
		score: proAvgScore
		});
	}

	function proUserRating(theScore, rating){
	$('.pro_user_rating').raty({
		starOn: '<%= asset_path('star-on.png') %>',
		starOff: '<%= asset_path('star-off.png') %>',
		click: function(score, evt) {
      $.ajax({
        url: '/ratings/new',
        type: 'POST',
        data: {
        	score: score,
        	rating_type: ratingType,
        	rating_id: ratingId
        },
        success: function(data){
        	alert("Thanks for rating me!");
        	proAverageRating(data.average_rating);
        }
      });
		}
	});
}

